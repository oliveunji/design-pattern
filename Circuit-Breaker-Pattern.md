# Circuit Breaker Pattern

원격 서비스 또는 리소스 연결 복구시 다양한 시간이 걸릴 수 있는 오류 처리

## Context
분산 환경에서 네트워크 이슈 등 일시적인 오류로 인해 서비스 호출이 실패할 수 있다. 
일반적으로 재시도 패턴을 사용하여 이를 처리한다.

그러나 성공할 가능성이 없는 작업을 계속하는 것은 무의미하며, 실패를 받아들이고 이에따른 처리를 할 필요가 있는 경우도 있다. 

또한 서비스 사용량이 많은 경우 한부분의 에러가 계단식 오류로 발생할 수 있다.
예시 - 서비스 호출 작업의 제한시간을 구현하고, 응답 없으면 실패로 구성
-> 제한시간 전까지 많은 동시 요청이 차단됨 -> 차단된 요청이 중요한 시스템 리소스 보유 
-> 다른 시스템에 오류 발생 .... 


## 해결책
실패할 가능성이 있는 작업을 계속 시도하는 것을 차단!
재시도 패턴과는 다른 부분이 재시도 패턴은 성공할 것이라는 기대를 가지고 계속 재시도 하는것임
회로차단기  패턴은 실패할 가능성이 있는 작업 수행을 방지
애플리케이션은 이 두 패턴을 결합할 수 있다. 

회로차단기 패턴은 실패할 수 있는 작업에 대한 프록시 역할을 한다
프록시는 다음의 상태 시스템으로 구현 가능
1. Closed : 최근 실패 횟수를 유지하며 실패시 횟수 증가, 임계값 넘으면 Open
2. Open: 애플리케이션 요청 즉시실패 & 예외 반환 
3. Half-Open:  애플리케이션의 제한된 수의 요청이 호출할 수 있음. (오류 복구 시간을 주는 것)

![image](https://user-images.githubusercontent.com/39396725/227539954-85279b3d-584c-487d-b5be-47b4b735bbfd.png)

- [회로차단기 패턴](https://learn.microsoft.com/en-us/azure/architecture/patterns/circuit-breaker)
