# Retry Pattern 
실패한 작업 재시도하는 패턴

## Context
클라우드 애플리케이션 실행하다 보면 네트웍 문제로 인해 일시적인 결함이 발생할 수 있다.
예를들면, 일시적 사용 불가능이나 시간초과 등등..
보통 이런경우는 몇번 재시도하면 성공하는 경우가 많다.
(DB의 경우 워크로드가 너무 몰리면 추가 요청을 일시적으로 거부한다)

## 해결책
일시적 오류는 드문일이 아니기 때문에 이를 우아하게 처리하기 위해서는 다음의 전략 사용가능

1. 취소
    일시적인 오류가 아닌경우(자격증명이 틀린경우) 작업 취소 후 예외 처리해야 함
1. 다시시도
    보고된 오류가 비정상적이거나 드문경우 패킷손상으로 인한 것일 수 있기 때문에 실패한 요청을 즉시 다시시도 한다. 
1. 지연 후 다시시도
    보다 일반적인 연결 오류나, 네트워크 바쁜경우 잠깐 기다렸다가 다시 시도한다.
    
애플리케이션은 위와 나열된 전략중 하나와 일치하는 재시도 정책을 구현해야 한다.
애플리케이션은 오류 및 실패한 작업의 세부 정보를 기록해야 한다. 

## 문제 및 고려사항
재시도 정책은 앱의 비즈니스 요구사항과 특성에 맞게 고려되야 함
재시도 사이의 간격이 너무 짧은 경우 서비스 성능 저하시킬 수 있음
상당수의 재시도 후에도 여전히 실패하는 경우, **회로차단기** 패턴 고려해야 함
트랜잭션의 경우, 트랜잭션의 일관성에 미치는 영향 고려해야 함

### 링크
- [Retry Pattern 안내문서](https://learn.microsoft.com/en-us/azure/architecture/patterns/retry)
- [Azure Service의 Retry 안내문서](https://learn.microsoft.com/en-us/azure/architecture/best-practices/retry-service-specific)
- [Retry 관련 프레임워크 - Resilience4j](https://github.com/resilience4j/resilience4j)
